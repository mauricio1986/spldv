% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sbinaryRis.R
\name{predict.binris}
\alias{predict.binris}
\title{Predictions for Spatial Binary RIS Models}
\usage{
\method{predict}{binris}(
  object,
  newdata,
  Sinv = NULL,
  het = TRUE,
  approximation = FALSE,
  pw = 5,
  ses = FALSE,
  theta = NULL,
  ...
)
}
\arguments{
\item{object}{An object of class \code{binris}.}

\item{newdata}{An optional data frame in which to look for variables with which to predict. 
If omitted, the original data used to fit the model is used.}

\item{Sinv}{Optional user-supplied spatial multiplier matrix \eqn{S = (I - \lambda W)^{-1}}. 
If \code{NULL}, it is computed using the spatial weight matrix.}

\item{het}{Logical. If \code{TRUE}, assumes a heteroskedastic error structure with spatially varying variances.}

\item{approximation}{Logical. If \code{TRUE}, uses power-series approximation to compute the inverse spatial matrix.}

\item{pw}{Integer. Power-order to use when \code{approximation = TRUE}.}

\item{ses}{Logical. If \code{TRUE}, standard errors of the predictions are computed using the Delta method.}

\item{theta}{Optional parameter vector (including \code{lambda}) to use for prediction instead of the estimated one.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A numeric vector of predicted probabilities if \code{ses = FALSE}. If \code{ses = TRUE}, returns a matrix with:
\describe{
  \item{\code{p_hat}}{Predicted probabilities.}
  \item{\code{Std. error}}{Standard errors of the predictions.}
  \item{\code{z value}}{Z-statistics.}
  \item{\code{Pr(> z)}}{Two-sided p-values.}
}
}
\description{
Computes predicted probabilities for spatial binary response models estimated via RIS. 
Supports probit models and  accounts for spatial heteroskedasticity, and optionally 
returns standard errors using the Delta method.
}
\details{
The function computes predicted probabilities \eqn{\hat{p}_i = F(a_i)} where \eqn{a_i} is a spatially filtered linear index. 
In the presence of heteroskedasticity (\code{het = TRUE}), the normalization involves the row-wise standard deviation 
of the spatial multiplier. When \code{ses = TRUE}, standard errors are computed using the analytical Jacobian of the 
prediction function with respect to the parameters and the estimated variance-covariance matrix.
}
\examples{
data(oldcol, package = "spdep")
# Create dependent (dummy) variable
COL.OLD$CRIMED <- as.numeric(COL.OLD$CRIME > 35)

# Estimate the model
ris_sar <- sbinaryRis(CRIMED ~ INC + HOVAL, data = COL.OLD,
                      R = 50,
                      listw = spdep::nb2listw(COL.nb, style = "W"))
                      
# Predicted probabilities with SES
out <- predict(ris_sar, ses = TRUE)
head(out, 5)

}
\seealso{
\code{\link{sbinaryRis}}
}
\author{
Mauricio Sarrias and Gianfranco Piras.
}
\keyword{prediction}
