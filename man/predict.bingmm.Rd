% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sbinaryGMM.R
\name{predict.bingmm}
\alias{predict.bingmm}
\title{Predictions for Spatial Binary GMM Models}
\usage{
\method{predict}{bingmm}(
  object,
  newdata,
  Sinv = NULL,
  het = TRUE,
  approximation = FALSE,
  pw = 5,
  ses = FALSE,
  vce = c("robust", "efficient", "ml"),
  theta = NULL,
  ...
)
}
\arguments{
\item{object}{An object of class \code{bingmm} returned by a spatial binary GMM estimation function.}

\item{newdata}{An optional data frame in which to look for variables with which to predict. 
If omitted, the original data used to fit the model is used.}

\item{Sinv}{Optional user-supplied spatial multiplier matrix \eqn{S = (I - \lambda W)^{-1}}. 
If \code{NULL}, it is computed using the spatial weight matrix.}

\item{het}{Logical. If \code{TRUE}, assumes a heteroskedastic error structure with spatially varying variances.}

\item{approximation}{Logical. If \code{TRUE}, uses power-series approximation to compute the inverse spatial matrix.}

\item{pw}{Integer. Power-order to use when \code{approximation = TRUE}.}

\item{ses}{Logical. If \code{TRUE}, standard errors of the predictions are computed using the Delta method.}

\item{vce}{Type of variance-covariance estimator: \code{"robust"} (default), \code{"efficient"}, or \code{"ml"}.}

\item{theta}{Optional parameter vector (including \code{lambda}) to use for prediction instead of the estimated one.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A numeric vector of predicted probabilities if \code{ses = FALSE}. If \code{ses = TRUE}, returns a matrix with:
\describe{
  \item{\code{p_hat}}{Predicted probabilities.}
  \item{\code{Std. error}}{Standard errors of the predictions.}
  \item{\code{z value}}{Z-statistics.}
  \item{\code{Pr(> z)}}{Two-sided p-values.}
}
}
\description{
Computes predicted probabilities for spatial binary response models estimated via GMM. 
Supports both probit and logit links, accounts for spatial heteroskedasticity, and optionally 
returns standard errors using the Delta method with robust or efficient variance estimators.
}
\details{
The function computes predicted probabilities \eqn{\hat{p}_i = F(a_i)} where \eqn{a_i} is a spatially filtered linear index. 
In the presence of heteroskedasticity (\code{het = TRUE}), the normalization involves the row-wise standard deviation 
of the spatial multiplier. When \code{ses = TRUE}, standard errors are computed using the analytical Jacobian of the 
prediction function with respect to the parameters and the estimated variance-covariance matrix.
}
\examples{
# Data set
data(oldcol, package = "spdep")

# Create dependent (dummy) variable
COL.OLD$CRIMED <- as.numeric(COL.OLD$CRIME > 35)

# Two-step (Probit) GMM estimator
ts <- sbinaryGMM(CRIMED ~ INC*HOVAL + factor(CP),
                link = "probit", 
                listw = spdep::nb2listw(COL.nb, style = "W"), 
                data = COL.OLD, 
                type = "twostep",
                verbose = FALSE)
                
# Compute just the predicted probability
p_hat <- predict(ts)

# Compute predicted probability and standard errors
res <- predict(ts, ses = TRUE, het = TRUE, vce = "efficient")
head(res)
}
\seealso{
\code{\link{sbinaryGMM}}, \code{\link{vcov.bingmm}}
}
\author{
Mauricio Sarrias and Gianfranco Piras.
}
\keyword{prediction}
